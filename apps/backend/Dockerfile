FROM node:20

WORKDIR /app

COPY package*.json ./
COPY tsconfig*.json ./

COPY ./libs ./libs
COPY ./prisma ./prisma               
COPY ./apps/backend ./apps/backend

RUN npm install
RUN npm run build

# üëá –î–æ–±–∞–≤–ª—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
CMD npx prisma migrate deploy && node dist/apps/backend/main.js